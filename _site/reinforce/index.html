<!DOCTYPE html>
<html >
	<head>
		

<meta charset="UTF-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, minimum-scale=1.0">
<meta name="google-site-verification" content="googlef9130e9561130734.html" />
<title>Reinforcement Learning from Scratch | InchanBaek Note - AI, Architecture & Technology</title>

	<meta name="description" content="ê°•í™”í•™ìŠµì˜ ê¸°ë³¸ ê°œë…ë¶€í„° ê³ ê¸‰ ì•Œê³ ë¦¬ì¦˜ê¹Œì§€, ì´ë¡ ê³¼ ì‹¤ìŠµì„ í†µí•´ ì²˜ìŒë¶€í„° ì°¨ê·¼ì°¨ê·¼ ë°°ìš°ëŠ” ê°•í™”í•™ìŠµ ê¸°ì´ˆ ê°€ì´ë“œì…ë‹ˆë‹¤.">


	<meta name="keywords" content="ê°•í™”í•™ìŠµ, ë¨¸ì‹ ëŸ¬ë‹, ì¸ê³µì§€ëŠ¥, ì¸ì°¬ë°±, InchanBaek, ë¦¬ì›Œë“œ, ì—ì´ì „íŠ¸, ì•¡ì…˜, MDP, ë§ˆë¥´ì½”í”„ ê²°ì • ê³¼ì •, Q-ëŸ¬ë‹, reinforcement learning, machine learning, AI, reward, agent, action, Markov decision process, Q-learning, deep reinforcement learning">

<meta name="author" content="Inchan Baek">
<!-- Open Graph / Facebook -->
<meta property="og:type" content="website">
<meta property="og:url" content="http://localhost:4000/reinforce/">
<meta property="og:title" content="Reinforcement Learning from Scratch | InchanBaek Note - AI, Architecture & Technology">
<meta property="og:description" content="ê°•í™”í•™ìŠµì˜ ê¸°ë³¸ ê°œë…ë¶€í„° ê³ ê¸‰ ì•Œê³ ë¦¬ì¦˜ê¹Œì§€, ì´ë¡ ê³¼ ì‹¤ìŠµì„ í†µí•´ ì²˜ìŒë¶€í„° ì°¨ê·¼ì°¨ê·¼ ë°°ìš°ëŠ” ê°•í™”í•™ìŠµ ê¸°ì´ˆ ê°€ì´ë“œì…ë‹ˆë‹¤.">
<!-- Twitter -->
<meta property="twitter:card" content="summary">
<meta property="twitter:url" content="http://localhost:4000/reinforce/">
<meta property="twitter:title" content="Reinforcement Learning from Scratch | InchanBaek Note - AI, Architecture & Technology">
<meta property="twitter:description" content="ê°•í™”í•™ìŠµì˜ ê¸°ë³¸ ê°œë…ë¶€í„° ê³ ê¸‰ ì•Œê³ ë¦¬ì¦˜ê¹Œì§€, ì´ë¡ ê³¼ ì‹¤ìŠµì„ í†µí•´ ì²˜ìŒë¶€í„° ì°¨ê·¼ì°¨ê·¼ ë°°ìš°ëŠ” ê°•í™”í•™ìŠµ ê¸°ì´ˆ ê°€ì´ë“œì…ë‹ˆë‹¤.">
<link rel="icon" href="/favicon.ico" type="image/x-icon">
<link rel="canonical" href="http://localhost:4000/reinforce/">
<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Reinforcement Learning from Scratch</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Reinforcement Learning from Scratch" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="ê°•í™”í•™ìŠµì˜ ê¸°ë³¸ ê°œë…ë¶€í„° ê³ ê¸‰ ì•Œê³ ë¦¬ì¦˜ê¹Œì§€, ì´ë¡ ê³¼ ì‹¤ìŠµì„ í†µí•´ ì²˜ìŒë¶€í„° ì°¨ê·¼ì°¨ê·¼ ë°°ìš°ëŠ” ê°•í™”í•™ìŠµ ê¸°ì´ˆ ê°€ì´ë“œì…ë‹ˆë‹¤." />
<meta property="og:description" content="ê°•í™”í•™ìŠµì˜ ê¸°ë³¸ ê°œë…ë¶€í„° ê³ ê¸‰ ì•Œê³ ë¦¬ì¦˜ê¹Œì§€, ì´ë¡ ê³¼ ì‹¤ìŠµì„ í†µí•´ ì²˜ìŒë¶€í„° ì°¨ê·¼ì°¨ê·¼ ë°°ìš°ëŠ” ê°•í™”í•™ìŠµ ê¸°ì´ˆ ê°€ì´ë“œì…ë‹ˆë‹¤." />
<link rel="canonical" href="http://localhost:4000/reinforce/" />
<meta property="og:url" content="http://localhost:4000/reinforce/" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Reinforcement Learning from Scratch" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"ê°•í™”í•™ìŠµì˜ ê¸°ë³¸ ê°œë…ë¶€í„° ê³ ê¸‰ ì•Œê³ ë¦¬ì¦˜ê¹Œì§€, ì´ë¡ ê³¼ ì‹¤ìŠµì„ í†µí•´ ì²˜ìŒë¶€í„° ì°¨ê·¼ì°¨ê·¼ ë°°ìš°ëŠ” ê°•í™”í•™ìŠµ ê¸°ì´ˆ ê°€ì´ë“œì…ë‹ˆë‹¤.","headline":"Reinforcement Learning from Scratch","url":"http://localhost:4000/reinforce/"}</script>
<!-- End Jekyll SEO tag -->

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,400i,500,500i,700,700i|Noto+Sans:400,400i,700,700i|Source+Code+Pro&amp;subset=latin-ext">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/moonspam/NanumSquare@1.0/nanumsquare.css">
<link rel="stylesheet" href="/doks-theme/assets/css/style.css">
<link rel="stylesheet" href="/doks-theme/assets/css/custom.css">
<script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", function() {
    mermaid.initialize({
      startOnLoad: true,
      theme: 'default',
      securityLevel: 'loose'
    });
    
    // Find all pre blocks with mermaid class and render them
    document.querySelectorAll('pre code.language-mermaid').forEach(function(element) {
      // Get the mermaid code
      const mermaidCode = element.textContent;
      
      // Create a new div for the mermaid diagram
      const newDiv = document.createElement('div');
      newDiv.className = 'mermaid';
      newDiv.textContent = mermaidCode;
      
      // Replace the pre element with the new div
      const preElement = element.parentElement;
      preElement.parentElement.replaceChild(newDiv, preElement);
    });
    
    // Trigger mermaid render
    mermaid.init();
  });
</script>

	</head>
	<body class="blue" data-spy="scroll" data-target=".js-scrollspy">
		
		


	<header class="site-header">
		<div class="container">
			<div class="row">
				<div class="col-xs-12">
					
						<a href="/" class="site-header__logo">InchanBaek Note</a>
					
					
				</div><!-- /.col -->
			</div><!-- /.row -->
		</div><!-- /.container -->
	</header><!-- /.site-header -->


		<div class="hero-subheader">
			<div class="container">
				<div class="row">
					<div class="col-md-7">
						<div class="align-container" data-mh>
							<div class="align-inner">
								
									<h1 class="hero-subheader__title">Reinforcement Learning from Scratch</h1>
								
								
									<p class="hero-subheader__desc">ê°•í™”í•™ìŠµì˜ ê¸°ë³¸ ê°œë…ë¶€í„° ê³ ê¸‰ ì•Œê³ ë¦¬ì¦˜ê¹Œì§€, ì´ë¡ ê³¼ ì‹¤ìŠµì„ í†µí•´ ì²˜ìŒë¶€í„° ì°¨ê·¼ì°¨ê·¼ ë°°ìš°ëŠ” ê°•í™”í•™ìŠµ ê¸°ì´ˆ ê°€ì´ë“œì…ë‹ˆë‹¤.</p>
								
								
							</div><!-- /.align-inner -->
						</div><!-- /.align-container -->
					</div><!-- /.col -->
					
				</div><!-- /.row -->
			</div><!-- /.container -->
		</div><!-- /.hero-subheader -->
		<div class="section">
			<div class="container">
				<div class="row">
					<div class="col-md-7">
						<div class="content">
							<script type="text/javascript" async="" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

<h2 id="ë°´ë””íŠ¸-ë¬¸ì œ-bandit-problem">ë°´ë””íŠ¸ ë¬¸ì œ (Bandit Problem)</h2>

<h3 id="ê°•í™”í•™ìŠµ">ê°•í™”í•™ìŠµ</h3>

<ul>
  <li>
    <p>ì§€ë„í•™ìŠµ (Supervised Learning) : ì…ë ¥ê³¼ ì¶œë ¥ ë°ì´í„°ê°€ ì£¼ì–´ì¡Œì„ ë•Œ, ì…ë ¥ ë°ì´í„°ì™€ ì¶œë ¥ ë°ì´í„° ì‚¬ì´ì˜ ê´€ê³„ë¥¼ ëª¨ë¸ë§í•˜ëŠ” ê¸°ê³„í•™ìŠµì˜ í•œ ë°©ë²•</p>
  </li>
  <li>
    <p>ë¹„ì§€ë„í•™ìŠµ (Unsupervised Learning) : ì…ë ¥ ë°ì´í„°ë§Œ ì£¼ì–´ì¡Œì„ ë•Œ, ì…ë ¥ ë°ì´í„°ì˜ íŠ¹ì§•ì„ ì°¾ì•„ë‚´ëŠ” ê¸°ê³„í•™ìŠµì˜ í•œ ë°©ë²•</p>
  </li>
  <li>
    <p>ê°•í™”í•™ìŠµ (Reinforcement Learning) : ì—ì´ì „íŠ¸ê°€ í™˜ê²½ê³¼ ìƒí˜¸ì‘ìš©í•˜ë©°, í™˜ê²½ì— ëŒ€í•œ ì •ë³´ë¥¼ ë°›ì•„ ë³´ìƒì„ ìµœëŒ€í™”í•˜ëŠ” í–‰ë™ì„ ì„ íƒí•˜ëŠ” ë°©ë²•</p>
  </li>
</ul>

<h3 id="ë°´ë””íŠ¸-ë¬¸ì œë€">ë°´ë””íŠ¸ ë¬¸ì œë€?</h3>

<p>ë°´ë””íŠ¸ == ìŠ¬ë¡¯ë¨¸ì‹ </p>

<p>ìŠ¬ë¡¯ë¨¸ì‹ ì€ ê°ê°ì˜ í™•ë¥ ì´ ë‹¤ë¦„.</p>

<p>ì²˜ìŒì—ëŠ” ì–´ë–¤ ìŠ¬ë¡¯ë¨¸ì‹ ì´ ê°€ì¥ ì¢‹ì€ì§€ ëª¨ë¦„.</p>

<p>ì‹¤ì œë¡œ í”Œë ˆì´ë¥¼ í•´ë³´ë©´ì„œ ì¢‹ì€ ë¨¸ì‹ ì„ ì°¾ì•„ì•¼ í•¨.</p>

<p>ì •í•´ì§„ íšŸìˆ˜ ì•ˆì— ìµœëŒ€í•œ ë§ì´ ë³´ìƒì„ ì–»ëŠ” ê²ƒì´ ëª©í‘œ.</p>

<div align="center">
  <div class="mermaid">
    graph LR
    A[Agent] --&gt;|í–‰ë™| B[Environment]
    B --&gt;|ë³´ìƒ| A
  </div>
</div>

<p><strong>í”Œë ˆì´ì–´ì¸ ì—ì´ì „íŠ¸ëŠ” ì£¼ì–´ì§„ í™˜ê²½ì—ì„œ í–‰ë™ì„ ì„ íƒí•˜ê³ , í™˜ê²½ì€ ì—ì´ì „íŠ¸ì—ê²Œ ë³´ìƒì„ ì œê³µí•œë‹¤.</strong></p>

<p>ëª©í‘œ : <strong>ë³´ìƒì„ ìµœëŒ€í™”í•˜ëŠ” í–‰ë™ì„ ì„ íƒí•˜ëŠ” ê²ƒ</strong> -&gt; <strong>ì½”ì¸ì„ ìµœëŒ€í•œ ë§ì´ ì–»ëŠ” ê²ƒ</strong> -&gt; <strong>ì¢‹ì€ ìŠ¬ë¡¯ë¨¸ì‹ ì„ ì°¾ëŠ” ê²ƒ</strong></p>

<h3 id="ê°€ì¹˜ì™€-í–‰ë™ê°€ì¹˜">ê°€ì¹˜ì™€ í–‰ë™ê°€ì¹˜</h3>

<ul>
  <li>ê°€ì¹˜ (Value) : íŠ¹ì • ìƒíƒœì—ì„œ ì–»ì„ ìˆ˜ ìˆëŠ” ë³´ìƒì˜ ê¸°ëŒ€ê°’</li>
</ul>

\[E[R_t]\]

<ul>
  <li>í–‰ë™ê°€ì¹˜ (Action Value) :í–‰ë™ì˜ ê²°ê³¼ë¡œ ì–»ì€ ë³´ìƒì˜ ê¸°ëŒ€ê°’</li>
</ul>

\[Q(A) = E[R_t | A]\]

<p>(E = Expectation, Q = Quality, A = Action, R = Reward)</p>

<p>ìŠ¬ë¡¯ ë¨¸ì‹  aì™€ bì˜ ë³´ìƒì˜ ê¸°ëŒ“ê°’ì„ êµ¬í•´ë³´ì.</p>

<p>ë°‘ì—ëŠ” ìŠ¬ë¡¯ë¨¸ì‹  aì— ëŒ€í•œ í‘œì´ë‹¤.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">ìŠ¬ë¡¯ë¨¸ì‹  a</th>
      <th style="text-align: center">Â </th>
      <th style="text-align: center">Â </th>
      <th style="text-align: center">Â </th>
      <th style="text-align: center">Â </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">ì–»ì„ ìˆ˜ ìˆëŠ” ì½”ì¸</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">5</td>
      <td style="text-align: center">10</td>
    </tr>
    <tr>
      <td style="text-align: center">ë³´ìƒ</td>
      <td style="text-align: center">0.70</td>
      <td style="text-align: center">0.15</td>
      <td style="text-align: center">0.12</td>
      <td style="text-align: center">0.03</td>
    </tr>
  </tbody>
</table>

<p>ìŠ¬ë¡¯ ë¨¸ì‹  bì— ëŒ€í•œ í‘œì´ë‹¤.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">ìŠ¬ë¡¯ë¨¸ì‹  b</th>
      <th style="text-align: center">Â </th>
      <th style="text-align: center">Â </th>
      <th style="text-align: center">Â </th>
      <th style="text-align: center">Â </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">ì–»ì„ ìˆ˜ ìˆëŠ” ì½”ì¸</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">5</td>
      <td style="text-align: center">10</td>
    </tr>
    <tr>
      <td style="text-align: center">ë³´ìƒ</td>
      <td style="text-align: center">0.50</td>
      <td style="text-align: center">0.40</td>
      <td style="text-align: center">0.09</td>
      <td style="text-align: center">0.01</td>
    </tr>
  </tbody>
</table>

<p>ë‘ ë¨¸ì‹ ì— ëŒ€í•œ ê¸°ëŒ“ê°’ì€</p>

<ul>
  <li>ìŠ¬ë¡¯ë¨¸ì‹  a : (0.7 * 0 + 0.15 * 1 + 0.12 * 5 + 0.03 * 10) = 1.05</li>
  <li>ìŠ¬ë¡¯ë¨¸ì‹  b : (0.5 * 0 + 0.4 * 1 + 0.09 * 5 + 0.01 * 10) = 0.95</li>
</ul>

<p>ìŠ¬ë¡¯ë¨¸ì‹  aê°€ ìŠ¬ë¡¯ë¨¸ì‹  bë³´ë‹¤ ì¢‹ë‹¤.</p>

<h3 id="ê°€ì¹˜-ì¶”ì •">ê°€ì¹˜ ì¶”ì •</h3>

<p>në²ˆì˜ í”Œë ˆì´ë¥¼ í•˜ë©´ì„œ ì–»ì€ ë³´ìƒì„ R1, R2, â€¦, Rnì´ë¼ê³  í•˜ì.
ê·¸ë•Œ í–‰ë™ ê°€ì¹˜ì˜ ì¶”ì •ì¹˜ Qnì€ ë‹¤ìŒê³¼ ê°™ì´ ê³„ì‚°í•  ìˆ˜ ìˆë‹¤.</p>

\[Q_n = \frac{R_1 + R_2 + ... + R_n}{n}\]

<p>í•˜ì§€ë§Œ ë§Œì•½ ì´ë ‡ê²Œ në²ˆ í”Œë ˆì´ í•˜ë©´ì„œ ê°€ì¹˜ ì¶”ì •ì„ í•œë‹¤ë©´ ê³„ì‚°ëŸ‰ê³¼ ë©”ëª¨ë¦¬ ë¶€í•˜ê°€ ì»¤ì§„ë‹¤.
n - 1ë²ˆì§¸ì˜ ê°€ì¹˜ ì¶”ì •ì¹˜ë¥¼ ì´ìš©í•´ì„œ në²ˆì§¸ ê°€ì¹˜ ì¶”ì •ì¹˜ë¥¼ ê³„ì‚°í•  ìˆ˜ ìˆë‹¤.</p>

\[Q_{n-1} = \frac{R_1 + R_2 + ... + R_{n-1}}{n-1}\]

<p>ì´ì‹ì˜ ì–‘ë³€ì— (n - 1)ì„ ê³±í•˜ë©´</p>

\[(n - 1)Q_{n-1} = R_1 + R_2 + ... + R_{n-1}\]

<p>ì´ì œ në²ˆì§¸ ê°€ì¹˜ ì¶”ì •ì¹˜ë¥¼ ê³„ì‚°í•  ìˆ˜ ìˆë‹¤.</p>

\[Q_n = \frac{1}{n} (R_1 + R_2 + ... + R_{n-1} + R_n)\]

\[=\frac{1}{n} (n - 1)Q_{n-1} + \frac{1}{n} R_n\]

\[= Q_{n - 1} + \frac{1}{n} (R_n - Q_{n - 1})\]

<h3 id="í”Œë ˆì´ì–´ì˜-ì •ì±…">í”Œë ˆì´ì–´ì˜ ì •ì±…</h3>

<p>í™•ì‹¤í•˜ì§€ ì•Šì€ ì¶”ì •ì¹˜ë¥¼ ì „ì ìœ¼ë¡œ ì‹ ë¢°í•˜ë©´ ìµœì„ ì˜ í–‰ë™ì„ ë†“ì¹  ìˆ˜ ìˆìŒ. ë”°ë¼ì„œ ì—ì´ì „íŠ¸ëŠ” ë¶ˆí™•ì‹¤ì„±ì„ ì¤„ì—¬ ì¶”ì •ì˜ ì‹ ë¢°ë„ë¥¼ ë†’ì—¬ì•¼ í•œë‹¤.</p>

<ul>
  <li>ì •ì±… (Policy) : ì—ì´ì „íŠ¸ê°€ í™˜ê²½ê³¼ ìƒí˜¸ì‘ìš©í•  ë•Œ, ì—ì´ì „íŠ¸ê°€ ì„ íƒí•˜ëŠ” í–‰ë™ì„ ê²°ì •í•˜ëŠ” ì „ëµ</li>
</ul>

<p>ë¶ˆí™•ì‹¤ì„±ì„ ì¤„ì´ê¸° ìœ„í•´ì„œëŠ” ë‘ê°€ì§€ ì •ì±…ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</p>

<ol>
  <li><strong>íƒí—˜ (Exploration)</strong> : ë¶ˆí™•ì‹¤í•œ í–‰ë™ì„ ì„ íƒí•˜ì—¬ í™˜ê²½ì— ëŒ€í•œ ì •ë³´ë¥¼ ì–»ëŠ” ê²ƒ</li>
  <li><strong>í™œìš© (Exploitation)</strong> : í˜„ì¬ê¹Œì§€ì˜ ì •ë³´ë¥¼ í™œìš©í•˜ì—¬ ìµœì„ ì˜ í–‰ë™ì„ ì„ íƒí•˜ëŠ” ê²ƒ</li>
</ol>

<p>ê²°êµ­ ê°•í™”í•™ìŠµì•Œê³ ë¦¬ì¦˜ì€ â€˜í™œìš©ê³¼ íƒí—˜ì˜ ê· í˜•â€™ì„ ë§ì¶”ëŠ” ê²ƒ!!!!</p>

<h3 id="ì—¡ì‹¤ë¡ -ê·¸ë¦¬ë””-ì •ì±…">ì—¡ì‹¤ë¡ -ê·¸ë¦¬ë”” ì •ì±…</h3>
<p>íƒí—˜ê³¼ í™œìš©ì˜ ê· í˜•ì„ ë§ì¶”ê¸° ìœ„í•œ ë°©ë²•ì˜ ì•Œê³ ë¦¬ì¦˜ ì¤‘ í•˜ë‚˜ì´ë‹¤. 
ì˜ˆë¥¼ ë“¤ì–´, \(\epsilon\) = 0.1ë¡œ ì„¤ì •í•˜ë©´ 10%ì˜ í™•ë¥ ë¡œ ë¬´ì‘ìœ„ í–‰ë™ì„ ì„ íƒí•˜ê³ , 90%ì˜ í™•ë¥ ë¡œ ê°€ì¥ ì¢‹ì€ í–‰ë™ì„ ì„ íƒí•œë‹¤.</p>

<h3 id="ë°´ë””íŠ¸-ë¬¸ì œì˜-í•´ê²°">ë°´ë””íŠ¸ ë¬¸ì œì˜ í•´ê²°</h3>

<ul>
  <li><strong>í–‰ë™ê°€ì¹˜ ì¶”ì •</strong> : í–‰ë™ê°€ì¹˜ë¥¼ ì¶”ì •í•˜ê³ , ê°€ì¥ ì¢‹ì€ í–‰ë™ì„ ì„ íƒí•œë‹¤.</li>
  <li><strong>ì •ì±…</strong> : ì—¡ì‹¤ë¡ -ê·¸ë¦¬ë”” ì •ì±…ì„ ì‚¬ìš©í•˜ì—¬ íƒí—˜ê³¼ í™œìš©ì˜ ê· í˜•ì„ ë§ì¶˜ë‹¤.</li>
</ul>

<p>ê·¸ëŸ¼ ìœ„ì˜ ë‚´ìš©ì„ ì½”ë“œë¡œ êµ¬í˜„í•´ë³´ì.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="k">class</span> <span class="nc">Bandit</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">arms</span> <span class="o">=</span> <span class="mi">10</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">rates</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.38991635</span><span class="p">,</span> <span class="mf">0.5937864</span><span class="p">,</span>  <span class="mf">0.55356798</span><span class="p">,</span> <span class="mf">0.46228943</span><span class="p">,</span> <span class="mf">0.48251845</span><span class="p">,</span> <span class="mf">0.47595196</span><span class="p">,</span> <span class="mf">0.53560295</span><span class="p">,</span> <span class="mf">0.43374032</span><span class="p">,</span> <span class="mf">0.55913105</span><span class="p">,</span> <span class="mf">0.57484477</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">play</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">arm</span><span class="p">):</span>
        <span class="n">rate</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">rates</span><span class="p">[</span><span class="n">arm</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">rate</span> <span class="o">&gt;</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">rand</span><span class="p">():</span>
            <span class="k">return</span> <span class="mi">1</span>
        <span class="k">else</span> <span class="p">:</span> 
            <span class="k">return</span> <span class="mi">0</span>


<span class="k">class</span> <span class="nc">Agent</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">epslion</span><span class="p">,</span> <span class="n">action_size</span> <span class="o">=</span> <span class="mi">10</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">epslion</span> <span class="o">=</span> <span class="n">epslion</span>
        <span class="n">self</span><span class="p">.</span><span class="n">Qs</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">(</span><span class="n">action_size</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">Ns</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">(</span><span class="n">action_size</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">reward</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">Ns</span><span class="p">[</span><span class="n">action</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">self</span><span class="p">.</span><span class="n">Qs</span><span class="p">[</span><span class="n">action</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">reward</span> <span class="o">-</span> <span class="n">self</span><span class="p">.</span><span class="n">Qs</span><span class="p">[</span><span class="n">action</span><span class="p">])</span> <span class="o">/</span> <span class="n">self</span><span class="p">.</span><span class="n">Ns</span><span class="p">[</span><span class="n">action</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">get_action</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">rand</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">self</span><span class="p">.</span><span class="n">epslion</span><span class="p">:</span>
            <span class="nf">return </span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">randint</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">Qs</span><span class="p">)),</span> <span class="mi">0</span><span class="p">)</span>
        <span class="nf">return </span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">argmax</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">Qs</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">steps</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">agent</span> <span class="o">=</span> <span class="nc">Agent</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">bandit</span> <span class="o">=</span> <span class="nc">Bandit</span><span class="p">()</span>

<span class="n">total_reward</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">total_rewards</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">rates</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">actions</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
    <span class="n">act</span> <span class="o">=</span> <span class="n">agent</span><span class="p">.</span><span class="nf">get_action</span><span class="p">()</span>
    <span class="n">action</span> <span class="o">=</span> <span class="n">act</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">reward</span> <span class="o">=</span> <span class="n">bandit</span><span class="p">.</span><span class="nf">play</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
    <span class="n">agent</span><span class="p">.</span><span class="nf">update</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">reward</span><span class="p">)</span>
    <span class="n">total_reward</span> <span class="o">+=</span> <span class="n">reward</span>
    <span class="n">total_rewards</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">total_reward</span><span class="p">)</span>
    <span class="n">rates</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">total_reward</span> <span class="o">/</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">act</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">actions</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>

<span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">total_rewards</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">Total Reward</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Steps</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Total Reward</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">actions</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">Actions</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Steps</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Action</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">rates</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">Average Reward</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Steps</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Average Reward</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>

</code></pre></div></div>

<div align="center">
  <img src="/images/bandit.png" alt="bandit" width="100%" />
</div>

<p>ì•½ 10000ë²ˆì˜ í”Œë ˆì´ë¥¼ í•˜ë©´ ì¸ë±ìŠ¤ 1ë²ˆì˜ ìŠ¬ë¡¯ë¨¸ì‹ ì„ ì•¡ì…˜ìœ¼ë¡œ ì„ íƒí•˜ëŠ” ê²ƒì´ ìµœì„ ì„ì„ ì•„ì§ì„ ì•Œì§€ ëª»í•œë‹¤. 
ë” ë§ì€ ìŠ¤í…ì„ ì£¼ì–´ë³´ì.</p>

<div align="center">
  <img src="/images/bandit2.png" alt="bandit" width="100%" />
</div>

<p>ì•½ 30000ë²ˆì˜ í”Œë ˆì´ë¥¼ í•˜ë©´ ì¸ë±ìŠ¤ 1ë²ˆì˜ ìŠ¬ë¡¯ë¨¸ì‹ ì„ ì•¡ì…˜ìœ¼ë¡œ ì„ íƒí•˜ëŠ” ê²ƒì´ ìµœì„ ì„ì„ ì•Œê²Œ ëœë‹¤.
ì•½ 2%ì˜ í™•ë¥  ì°¨ì´ë¥¼ ì¸ì§€í•˜ê¸° ìœ„í•´ 20000ë²ˆì˜ í”Œë ˆì´ê°€ ë” í•„ìš”í–ˆë‹¤.</p>

<h3 id="ë¹„ì •ìƒ-ë¬¸ì œ-non-stationary-problem">ë¹„ì •ìƒ ë¬¸ì œ (Non-stationary Problem)</h3>

<p>ì§€ê¸ˆê¹Œì§€ ë‹¤ë£¬ ë°´ë””íŠ¸ ë¬¸ì œë¥¼ ì •ìƒë¬¸ì œì— ì†í•œë‹¤. ì •ìƒë¬¸ì œë€ ë³´ìƒì˜ í™•ë¥  ë¶„í¬ê°€ ë³€í•˜ì§€ ì•ŠëŠ” ë¬¸ì œì´ë‹¤. ìœ„ì˜ ì½”ë“œë¥¼ ë³´ë©´ ratesë¼ëŠ” ë³€ìˆ˜ì— í™•ë¥ ì´ ê³ ì •ë˜ì–´ ìˆë‹¤.</p>

<p>í•˜ì§€ë§Œ ì‹¤ì œë¡œëŠ” ë³´ìƒì˜ í™•ë¥  ë¶„í¬ê°€ ë³€í•˜ëŠ” ê²½ìš°ê°€ ë§ë‹¤. ì´ëŸ° ê²½ìš°ë¥¼ ë¹„ì •ìƒ ë¬¸ì œë¼ê³  í•œë‹¤. ì´ëŸ° ê²½ìš°ì—ëŠ” ì–´ë–»ê²Œ í•´ì•¼í• ê¹Œ?</p>

<p>ë¨¼ì € ì •ìƒ ë¬¸ì œì—ì„œëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì‹ìœ¼ë¡œ í–‰ë™ê°€ì¹˜ ì¶”ì •ì¹˜ë¥¼ ì—…ë°ì´íŠ¸ í–ˆë‹¤.</p>

\[Q_n = Q_{n - 1} + \frac{1}{n} (R_n - Q_{n - 1})\]

<p>í•˜ì§€ë§Œ ë¹„ì •ìƒ ë¬¸ì œì—ì„œëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì‹ìœ¼ë¡œ í–‰ë™ê°€ì¹˜ ì¶”ì •ì¹˜ë¥¼ ì—…ë°ì´íŠ¸ í•œë‹¤.</p>

\[Q_n = Q_{n - 1} + \alpha (R_n - Q_{n - 1})\]

<p>ì˜¤ë˜ì „ì— ì–»ì€ ë³´ìƒì— ëŒ€í•œ ê°€ì¤‘ì¹˜ë¥¼ ì¤„ì´ê³ , ìµœê·¼ì— ì–»ì€ ë³´ìƒì— ëŒ€í•œ ê°€ì¤‘ì¹˜ë¥¼ ë†’ì´ëŠ” ë°©ë²•ì´ë‹¤. ì´ë•Œ \(\alpha\)ëŠ” í•™ìŠµë¥ ì´ë¼ê³  í•œë‹¤.</p>

<div style="overflow-x: auto;">

$$
= Q_{n - 1} + \alpha (R_n - Q_{n - 1})
$$
$$
= (1 - \alpha) Q_{n - 1} + \alpha R_n
$$
$$
= \alpha R_n + (1 - \alpha) {(\alpha R_{n - 1} + (1 - \alpha) Q_{n - 2})}
$$
$$
= \alpha R_n + (1 - \alpha) \alpha R_{n - 1} + (1 - \alpha)^2 Q_{n - 2}
$$
$$
= \alpha R_n + (1 - \alpha) \alpha R_{n - 1} + (1 - \alpha)^2 \alpha R_{n - 2} + (1 - \alpha)^3 Q_{n - 3}
$$
$$
= \alpha R_n + (1 - \alpha) \alpha R_{n - 1} + (1 - \alpha)^2 \alpha R_{n - 2} +
$$
$$
(1 - \alpha)^3 \alpha R_{n - 3} + ... + (1 - \alpha)^{n - 1} \alpha R_1 + (1 - \alpha)^n Q_0
$$

</div>

<p>\(Q_0\)ëŠ” ì´ˆê¸°ê°’ì´ë‹¤. ìš°ë¦¬ê°€ ì„¤ì •í•œ ê°’ì— ë”°ë¼ì„œ  í•™ìŠµê²°ê³¼ì— í¸í–¥ì´ ìƒê¸´ë‹¤. í•˜ì§€ë§Œ í‘œë³¸ í‰ê· ì„ ì‚¬ìš©í•˜ë©´ í¸í–¥ì´ ì‚¬ë¼ì§„ë‹¤.</p>

<p>ìœ„ì˜ ë°©ì‹ì„ ì§€ìˆ˜ì´ë™í‰ê· , ì§€ìˆ˜ê°€ì¤‘ì´ë™í‰ê· ì´ë¼ê³  í•œë‹¤.</p>

<ul>
  <li><strong>ì§€ìˆ˜ ê°€ì¤‘ ì´ë™ í‰ê·  (Exponential Weighted Moving Average)</strong> : ìµœê·¼ì— ì–»ì€ ë³´ìƒì— ë” ë§ì€ ê°€ì¤‘ì¹˜ë¥¼ ì£¼ê³ , ì˜¤ë˜ì „ì— ì–»ì€ ë³´ìƒì—ëŠ” ì ì€ ê°€ì¤‘ì¹˜ë¥¼ ì£¼ëŠ” ë°©ë²•</li>
</ul>

<p>python ì½”ë“œë¡œ êµ¬í˜„í•´ë³´ì.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="k">class</span> <span class="nc">Bandit</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">arms</span> <span class="o">=</span> <span class="mi">10</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">rates</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.38991635</span><span class="p">,</span> <span class="mf">0.7837864</span><span class="p">,</span>  <span class="mf">0.55356798</span><span class="p">,</span> <span class="mf">0.46228943</span><span class="p">,</span> <span class="mf">0.48251845</span><span class="p">,</span> <span class="mf">0.47595196</span><span class="p">,</span> <span class="mf">0.53560295</span><span class="p">,</span> <span class="mf">0.43374032</span><span class="p">,</span> <span class="mf">0.55913105</span><span class="p">,</span> <span class="mf">0.57484477</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">play</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">arm</span><span class="p">):</span>
        <span class="n">rate</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">rates</span><span class="p">[</span><span class="n">arm</span><span class="p">]</span>
        <span class="n">self</span><span class="p">.</span><span class="n">rates</span> <span class="o">+=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">randn</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">rates</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">rate</span> <span class="o">&gt;</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">rand</span><span class="p">():</span>
            <span class="k">return</span> <span class="mi">1</span>
        <span class="k">else</span> <span class="p">:</span> 
            <span class="k">return</span> <span class="mi">0</span>

<span class="k">class</span> <span class="nc">Agent</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">epslion</span><span class="p">,</span> <span class="n">action_size</span> <span class="o">=</span> <span class="mi">10</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">epslion</span> <span class="o">=</span> <span class="n">epslion</span>
        <span class="n">self</span><span class="p">.</span><span class="n">Qs</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">(</span><span class="n">action_size</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">Qs</span><span class="p">[</span><span class="n">action</span><span class="p">]</span> <span class="o">+=</span> <span class="n">alpha</span> <span class="o">*</span> <span class="p">(</span><span class="n">reward</span> <span class="o">-</span> <span class="n">self</span><span class="p">.</span><span class="n">Qs</span><span class="p">[</span><span class="n">action</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">get_action</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">rand</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">self</span><span class="p">.</span><span class="n">epslion</span><span class="p">:</span>
            <span class="nf">return </span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">randint</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">Qs</span><span class="p">)),</span> <span class="mi">0</span><span class="p">)</span>
        <span class="nf">return </span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">argmax</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">Qs</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span> 

<span class="n">steps</span> <span class="o">=</span> <span class="mi">50000</span>
<span class="n">agent</span> <span class="o">=</span> <span class="nc">Agent</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">bandit</span> <span class="o">=</span> <span class="nc">Bandit</span><span class="p">()</span>

<span class="n">total_reward</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">total_rewards</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">rates</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">actions</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
    <span class="n">act</span> <span class="o">=</span> <span class="n">agent</span><span class="p">.</span><span class="nf">get_action</span><span class="p">()</span>
    <span class="n">action</span> <span class="o">=</span> <span class="n">act</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">reward</span> <span class="o">=</span> <span class="n">bandit</span><span class="p">.</span><span class="nf">play</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
    <span class="n">agent</span><span class="p">.</span><span class="nf">update</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">reward</span><span class="p">)</span>
    <span class="n">total_reward</span> <span class="o">+=</span> <span class="n">reward</span>
    <span class="n">total_rewards</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">total_reward</span><span class="p">)</span>
    <span class="n">rates</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">total_reward</span> <span class="o">/</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">act</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">actions</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>

<span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">total_rewards</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">Total Reward</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Steps</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Total Reward</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">actions</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">Actions</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Steps</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Action</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">rates</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">Average Reward</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Steps</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Average Reward</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div>

<div align="center">
  <img src="/images/bandit3.png" alt="bandit" width="100%" />
</div>

<p>ê³ ì •ê°’ \(\alpha\) = 0.8ë¡œ ì„¤ì •í•˜ë©´ í‘œë³¸ í‰ê· ì„ ì‚¬ìš©í•œ ê²½ìš°ë³´ë‹¤ ë” ê²°ê³¼ê°€ ë¹¨ë¦¬ ìˆ˜ë ´í•˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.</p>

<h3 id="ì •ë¦¬">ì •ë¦¬</h3>

<ul>
  <li><strong>ë°´ë””íŠ¸ ë¬¸ì œ</strong> : ê°•í™”í•™ìŠµì˜ ê¸°ì´ˆ ë¬¸ì œë¡œ, ì—¬ëŸ¬ ê°œì˜ ìŠ¬ë¡¯ë¨¸ì‹  ì¤‘ì—ì„œ ìµœëŒ€ ë³´ìƒì„ ì–»ëŠ” ë°©ë²•ì„ ì°¾ëŠ” ë¬¸ì œ</li>
  <li><strong>í–‰ë™ê°€ì¹˜</strong> : í–‰ë™ì˜ ê²°ê³¼ë¡œ ì–»ì€ ë³´ìƒì˜ ê¸°ëŒ€ê°’</li>
  <li><strong>ì •ì±…</strong> : ì—ì´ì „íŠ¸ê°€ í™˜ê²½ê³¼ ìƒí˜¸ì‘ìš©í•  ë•Œ, ì—ì´ì „íŠ¸ê°€ ì„ íƒí•˜ëŠ” í–‰ë™ì„ ê²°ì •í•˜ëŠ” ì „ëµ</li>
  <li><strong>ì—¡ì‹¤ë¡ -ê·¸ë¦¬ë”” ì •ì±…</strong> : íƒí—˜ê³¼ í™œìš©ì˜ ê· í˜•ì„ ë§ì¶”ê¸° ìœ„í•œ ë°©ë²•ì˜ ì•Œê³ ë¦¬ì¦˜ ì¤‘ í•˜ë‚˜</li>
  <li><strong>ë¹„ì •ìƒ ë¬¸ì œ</strong> : ë³´ìƒì˜ í™•ë¥  ë¶„í¬ê°€ ë³€í•˜ëŠ” ë¬¸ì œ</li>
  <li><strong>ì§€ìˆ˜ ê°€ì¤‘ ì´ë™ í‰ê· </strong> : ìµœê·¼ì— ì–»ì€ ë³´ìƒì— ë” ë§ì€ ê°€ì¤‘ì¹˜ë¥¼ ì£¼ê³ , ì˜¤ë˜ì „ì— ì–»ì€ ë³´ìƒì—ëŠ” ì ì€ ê°€ì¤‘ì¹˜ë¥¼ ì£¼ëŠ” ë°©ë²•</li>
</ul>

<h2 id="ë§ˆë¥´ì½”í”„-ê²°ì •-ê³¼ì •-markov-decision-process">ë§ˆë¥´ì½”í”„ ê²°ì • ê³¼ì • (Markov Decision Process)</h2>

<p>ì—ë¦¬ì „íŠ¸ì˜ í–‰ë™ì— ë”°ë¼ í™˜ê²½ì˜ ìƒíƒœê°€ ë³€í•˜ëŠ” ë¬¸ì œë¥¼ ë‹¤ë£¨ì–´ë³´ì.</p>

<h3 id="ë§ˆë¥´ì½”í”„-ê²°ì •-ê³¼ì •ì´ë€">ë§ˆë¥´ì½”í”„ ê²°ì • ê³¼ì •ì´ë€?</h3>

<ul>
  <li>
    <p><strong>ë§ˆë¥´ì½”í”„ ê²°ì • ê³¼ì • (Markov Decision Process, MDP)</strong> : ì—ì´ì „íŠ¸ê°€ í™˜ê²½ê³¼ ìƒí˜¸ì‘ìš©í•˜ë©°, í™˜ê²½ì˜ ìƒíƒœê°€ ë§ˆë¥´ì½”í”„ ì„±ì§ˆì„ ë§Œì¡±í•˜ëŠ” í™˜ê²½ì„ ëª¨ë¸ë§í•˜ëŠ” ë°©ë²•</p>
  </li>
  <li>
    <p><strong>ë§ˆë¥´ì½”í”„ ì„±ì§ˆ</strong> : ë¯¸ë˜ì˜ ìƒíƒœê°€ í˜„ì¬ì˜ ìƒíƒœì—ë§Œ ì˜ì¡´í•˜ëŠ” ì„±ì§ˆ</p>
  </li>
</ul>

<p>MDPì—ëŠ” ì‹œê°„ ê°œë…ì´ í•„ìš”í•˜ë‹¤. íŠ¹ì • ì‹œê°„ì— ì—ì´ì „íŠ¸ê°€ í–‰ë™ì„ ì·¨í•˜ê³ , ê·¸ ê²°ê³¼ ìƒˆë¡œìš° ìƒíƒœë¡œ ì „ì´í•œë‹¤. ì´ë•Œì˜ ì‹œê°„ë‹¨ìœ„ë¥¼ time stepì´ë¼ê³  í•œë‹¤.</p>

<div align="center">
  <div class="mermaid">
    graph LR
    A[Agent] --&gt;|í–‰ë™| B[Environment]
    B --&gt;|ë³´ìƒ, ìƒíƒœ| A
  </div>
</div>

<ul>
  <li><strong>ìƒíƒœì „ì´</strong> : ìƒíƒœëŠ” ì–´ë–»ê²Œ ì „ì´ë˜ëŠ”ê°€?</li>
  <li><strong>ë³´ìƒ</strong> : ë³´ìƒì€ ì–´ë–»ê²Œ ì£¼ì–´ì§€ëŠ”ê°€?</li>
  <li><strong>ì •ì±…</strong> : ì—ì´ì „íŠ¸ëŠ” í–‰ë™ì„ ì–´ë–»ê²Œ ê²°ì •í•˜ëŠ”ê°€?</li>
</ul>

<p>ìœ„ì˜ ì„¸ê°€ì§€ ìš”ì†Œë¥¼ ìˆ˜ì‹ìœ¼ë¡œ í‘œí˜„í•´ì•¼í•œë‹¤.</p>

<p>ìƒíƒœì „ì´ê°€ ê²°ì •ì ì¼ ê²½ìš° ë‹¤ìŒ ìƒíƒœ sâ€™ëŠ” í˜„ì¬ ìƒíƒœ sì™€ í–‰ë™ aì—ë§Œ ì˜ì¡´í•œë‹¤.</p>

<p>ìƒíƒœì „ì´í•¨ìˆ˜ =&gt; 
\(s' = f(s, a)\)</p>

<p>ìƒíƒœì „ì´ê°€ í™•ë¥ ì ì¼ ê²½ìš° ë‹¤ìŒ ìƒíƒœ sâ€™ëŠ” í˜„ì¬ ìƒíƒœ sì™€ í–‰ë™ aì—ë§Œ ì˜ì¡´í•œë‹¤.</p>

<p>ìƒíƒœì „ì´í™•ë¥  =&gt;
\(P(s' | s, a)\)</p>

<h3 id="ë³´ìƒí•¨ìˆ˜">ë³´ìƒí•¨ìˆ˜</h3>

<p>ë³´ìƒí•¨ìˆ˜ëŠ” ìƒíƒœ sì™€ í–‰ë™ aì— ëŒ€í•œ ë³´ìƒì„ ë°˜í™˜í•œë‹¤.ì—ì´ì „íŠ¸ê°€ ìƒíƒœ sì—ì„œ í–‰ë™ aë¥¼ ì·¨í•˜ì—¬ ë‹¤ìŒ ìƒíƒœ sâ€™ë¡œ ì´ë™í–ˆì„ ë•Œ ë°›ëŠ” ë³´ìƒì„ ë°˜í™˜í•œë‹¤.</p>

<p>ë³´ìƒí•¨ìˆ˜ =&gt;
\(r(s, a, s')\)</p>

<h3 id="ì—ì´ì „íŠ¸ì˜-ì •ì±…">ì—ì´ì „íŠ¸ì˜ ì •ì±…</h3>

<p>ì—ì´ì „íŠ¸ì˜ ì •ì±…ì€ ì—ì´ì „íŠ¸ê°€ í–‰ë™ì„ ê²°ì •í•˜ëŠ” ë°©ì‹ì„ ë§í•œë‹¤. ì—ì´ì „íŠ¸ëŠ” â€˜í˜„ì¬ ìƒíƒœâ€™ ë§Œë“œì˜¤ í–‰ë™ì„ ê²°ì •í•œë‹¤.
ì™œëƒí•˜ë©´ â€˜í™˜ê²½ì— ëŒ€í•´ í•„ìš”í•œ ì •ë³´ëŠ” ëª¨ë‘ í˜„ì¬ ìƒíƒœì— ë‹´ê²¨â€™ ìˆê¸° ë•Œë¬¸ì´ë‹¤.</p>

<p>ì—ì´ì „íŠ¸ê°€ í™•ë¥ ì ìœ¼ë¡œ ê²°ì •ë˜ëŠ” ì •ì±…ì„ ë‹¤ìŒê³¼ ê°™ì´ í‘œí˜„í•  ìˆ˜ ìˆë‹¤.</p>

<p>ì •ì±… =&gt;
\(\pi(a | s) = P(a | s)\)</p>

<h3 id="mdpì˜-ëª©í‘œ">MDPì˜ ëª©í‘œ</h3>

<p>MDPì˜ ëª©í‘œëŠ” ë³´ìƒì„ ìµœëŒ€í™”í•˜ëŠ” ì •ì±…ì„ ì°¾ëŠ” ê²ƒì´ë‹¤. ì—ì´ì „ëŠ” ì •ì±… 
\(\pi(a | s)\)
ì— ë”°ë¼ í–‰ë™í•œë‹¤. ê·¸ í–‰ë™ê³¼ ìƒíƒœ ì „ì´ í™•ë¥  \(P(s' | s, a)\) ì— ë”°ë¼ ë‹¤ìŒ ìƒíƒœê°€ ê²°ì •ëœë‹¤. ê·¸ë¦¬ê³  ë³´ìƒí•¨ìˆ˜ \(r(s, a, s')\) ì— ë”°ë¼ ë³´ìƒì„ ë°›ëŠ”ë‹¤.</p>

<h3 id="return--ìˆ˜ìµ">return : ìˆ˜ìµ</h3>

<p>ì‹œê°„ tì—ì„œì˜ ìƒíƒœë¥¼ \(S_t\), ì •ì±… \(\pi\) ì— ë”°ë¼ í–‰ë™ì„ \(A_t\), ë³´ìƒì„ \(R_t\)ë¥¼ ì–»ê³ , ìƒˆë¡œìš´ ìƒíƒœ \(S_{t+1}\)ì „ì´ë˜ëŠ” íë¦„ìœ¼ë¡œ ì´ì–´ì§„ë‹¤. ì´ë•Œì˜ ìˆ˜ìµì€ ë‹¤ìŒê³¼ ê°™ì´ ì •ì˜í•  ìˆ˜ ìˆë‹¤.</p>

\[G_t = R_t + rR_{t+1} + r^2R_{t+2} + ... = \sum_{k=0}^{\infty} r^k R_{t+k}\]

<p>ì‹œê°„ì´ ì§€ë‚ ìˆ˜ë¡ ë³´ìƒì„ \(\gamma\) ì— ì˜í•´ ê¸°í•˜ê¸‰ìˆ˜ì ìœ¼ë¡œ ê°ì†Œí•œë‹¤.</p>

<h3 id="ìƒíƒœê°€ì¹˜í•¨ìˆ˜">ìƒíƒœê°€ì¹˜í•¨ìˆ˜</h3>

<p>ìˆ˜ìµì„ ê·¹ëŒ€í™” í™”ëŠ” ê²ƒì´ ì—ì´ì „íŠ¸ì˜ ëª©í‘œì„. ê°™ì€ ìƒíƒœì—ì„œ ì—ì´ì „íŠ¸ê°€ ì‹œì‘í•˜ë”ë¼ë„ ìˆ˜ìµì´ ì—í”¼ì†Œë“œë§ˆë‹¤ ë‹¤ë¥¼ ìˆ˜ ìˆë‹¤. ì´ëŸ¬í•œ í™•ë¥ ì  ë™ì‘ì— ëŒ€ì‘í•˜ê¸° ìœ„í•´, ê¸°ëŒ“ê°’, ì¦‰, ìˆ˜ìµì˜ ê¸°ëŒ“ê°’ì„ ì§€í‘œë¡œ ì‚¼ëŠ”ë‹¤.</p>

<p>ìƒíƒœ ê°€ì¹˜ í•¨ìˆ˜ëŠ” ê°•í™” í•™ìŠµì—ì„œ íŠ¹ì • ìƒíƒœì—ì„œ ì‹œì‘í•˜ì—¬ ë¯¸ë˜ì— ë°›ì„ ìˆ˜ ìˆëŠ” ë³´ìƒì˜ ê¸°ëŒ€ê°’ì„ ë‚˜íƒ€ë‚´ëŠ” í•¨ìˆ˜ë‹¤. ì¼ë°˜ì ìœ¼ë¡œ \(V(s)\)ë¡œ í‘œí˜„ë˜ë©°, ì—¬ê¸°ì„œ \(s\)ëŠ” ìƒíƒœë¥¼ ë‚˜íƒ€ë‚¸ë‹¤. ìƒíƒœ ê°€ì¹˜ í•¨ìˆ˜ëŠ” ì •ì±… \(\pi\)ì— ë”°ë¼ ê³„ì‚°ë˜ë©°, ìˆ˜ì‹ìœ¼ë¡œëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì •ì˜ëœë‹¤:</p>

<div style="overflow-x: auto;">
$$
V_{\pi}(s) = \mathbb{E} \left[ \sum_{t=0}^\infty \gamma^t R_{t+1} \mid S_t = s, \pi \right]
$$
</div>

\[= \mathbb{E}_\pi \left[G_t \mid S_t = s \right]\]

<p>ì—¬ê¸°ì„œ:</p>
<ul>
  <li>\(\mathbb{E}_\pi\): ì •ì±… \(\pi\)ì— ë”°ë¥¸ ê¸°ëŒ€ê°’</li>
  <li>\(\gamma\): í• ì¸ìœ¨ (0 â‰¤ \(\gamma\) &lt; 1)</li>
  <li>\(R_{t+1}\): ì‹œê°„ \(t+1\)ì—ì„œì˜ ë³´ìƒ</li>
  <li>\(S_0 = s\): ì´ˆê¸° ìƒíƒœ</li>
</ul>

<p>ì¦‰, ìƒíƒœ ê°€ì¹˜ í•¨ìˆ˜ëŠ” ì£¼ì–´ì§„ ì •ì±…ì„ ë”°ë¥¼ ë•Œ íŠ¹ì • ìƒíƒœì—ì„œ ì‹œì‘í•˜ì—¬ ì¥ê¸°ì ìœ¼ë¡œ ë°›ì„ ë³´ìƒì˜ ì´í•©ì„ ì˜ˆì¸¡í•˜ëŠ” ë° ì‚¬ìš©ëœë‹¤. ì´ëŠ” ì •ì±…ì˜ í’ˆì§ˆì„ í‰ê°€í•˜ê±°ë‚˜ ìµœì  ì •ì±…ì„ ì°¾ëŠ”ë° ì¤‘ìš”í•œ ì—­í• ì„ í•œë‹¤.</p>

<h3 id="ìµœì -ì •ì±…ê³¼-ìµœì -ê°€ì¹˜-í•¨ìˆ˜">ìµœì  ì •ì±…ê³¼ ìµœì  ê°€ì¹˜ í•¨ìˆ˜</h3>

<p>ê°•í™” í•™ìŠµì—ì„œ ìµœì  ì •ì±…(optimal policy) \(\pi^*\)ëŠ” ëª¨ë“  ìƒíƒœì—ì„œ ê¸°ëŒ€ ë³´ìƒì„ ìµœëŒ€í™”í•˜ëŠ” ì •ì±…ì´ë‹¤. ìµœì  ì •ì±…ì„ ë”°ë¥¸ë‹¤ë©´ ì—ì´ì „íŠ¸ëŠ” ê°€ëŠ¥í•œ ìµœëŒ€ ë³´ìƒì„ ì–»ì„ ìˆ˜ ìˆë‹¤.</p>

<p>ìµœì  ê°€ì¹˜ í•¨ìˆ˜(optimal value function) \(V^*(s)\)ëŠ” ìµœì  ì •ì±…ì„ ë”°ë¥¼ ë•Œ ìƒíƒœ \(s\)ì—ì„œ ì‹œì‘í•˜ì—¬ ì–»ì„ ìˆ˜ ìˆëŠ” ê¸°ëŒ€ ë³´ìƒì˜ í•©ì´ë‹¤:</p>

<div style="overflow-x: auto;">
$$
V^*(s) = \max_{\pi} V^{\pi}(s) = \max_{\pi} \mathbb{E}_{\pi} \left[ \sum_{t=0}^{\infty} \gamma^t R_{t+1} \mid S_0 = s \right]
$$
</div>

<p>ë§ˆì°¬ê°€ì§€ë¡œ, ìµœì  í–‰ë™ ê°€ì¹˜ í•¨ìˆ˜(optimal action-value function) \(Q^*(s,a)\)ëŠ” ìƒíƒœ \(s\)ì—ì„œ í–‰ë™ \(a\)ë¥¼ ì·¨í•˜ê³  ê·¸ ì´í›„ ìµœì  ì •ì±…ì„ ë”°ë¥¼ ë•Œ ì–»ì„ ìˆ˜ ìˆëŠ” ê¸°ëŒ€ ë³´ìƒì˜ í•©ì´ë‹¤:</p>

<div style="overflow-x: auto;">
$$
Q^*(s,a) = \max_{\pi} Q^{\pi}(s,a) = \max_{\pi} \mathbb{E}_{\pi} \left[ \sum_{t=0}^{\infty} \gamma^t R_{t+1} \mid S_0 = s, A_0 = a \right]
$$
</div>

<p>ìµœì  ì •ì±…ê³¼ ìµœì  ê°€ì¹˜ í•¨ìˆ˜ëŠ” ë²¨ë§Œ ìµœì  ë°©ì •ì‹(Bellman Optimality Equation)ì„ í†µí•´ ì •ì˜ë  ìˆ˜ ìˆë‹¤:</p>

<div style="overflow-x: auto;">
$$
V^*(s) = \max_{a} \left[ R(s,a) + \gamma \sum_{s'} P(s'|s,a) V^*(s') \right]
$$
</div>

<div style="overflow-x: auto;">
$$
Q^*(s,a) = R(s,a) + \gamma \sum_{s'} P(s'|s,a) \max_{a'} Q^*(s',a')
$$
</div>

<p>ê°•í™” í•™ìŠµì˜ ëª©í‘œëŠ” ì´ëŸ¬í•œ ìµœì  ì •ì±… ë˜ëŠ” ìµœì  ê°€ì¹˜ í•¨ìˆ˜ë¥¼ ì°¾ì•„ë‚´ëŠ” ê²ƒì´ë‹¤.</p>

<h2 id="bellman-equation">Bellman equation</h2>

<p>First, Summary of the Above.</p>

<ul>
  <li><strong>â“ What is an MDP?</strong></li>
</ul>

<p>An MDP is a mathematical framework used to model decision-making in environments where outcomes are partly random and partly under the control of an agent.</p>

<p>It consisis of :</p>

<ul>
  <li>A set of states (S)</li>
  <li>A set of actions (A)</li>
  <li>A transition Probablity function (P)</li>
  <li>A reward function (R)</li>
  <li>A discount factor (Î³)</li>
</ul>

<p>So, MDP is the foundation of reinforcement learning, where an agent learns to choose actions that maximize cumulative reward over time.</p>

<ul>
  <li><strong>â“Why is important Bellman equation in MDP?</strong></li>
</ul>

<p>The Bellman equation is important in Markov Decision Processes (MDPs) because it provides a recursive decomposition of the value function, which represents the expected return starting from a given state. It serves as the foundation for many reinforcement learning algorithms, enabling efficient computation of optimal policies by breaking down complex problems into smaller subproblems.</p>

<p>ğŸ”‘ Bellman Equation â€“ Easy Explanation (with Keywords)</p>
<ul>
  <li>
    <p><strong>The Bellman equation expresses</strong>
â€œWhat kind of future reward can I expect if I act well in this state?â€</p>
  </li>
  <li>
    <p><strong>It uses recursion to break down a complex problem into smaller subproblems.</strong></p>
  </li>
  <li>
    <p><strong>This allows us to efficiently and systematically optimize the overall policy.</strong></p>
  </li>
  <li>
    <p><strong>Many reinforcement learning algorithms like Q-learning and Value Iteration</strong>
are based on the Bellman equation.</p>
  </li>
</ul>

<h3 id="derivation-of-bellman-equation">Derivation of Bellman Equation.</h3>

<p>First, letâ€™s define â€˜Return at time tâ€™ as the sum of rewards from time â€˜tâ€™</p>

<div style="overflow-x: auto;">
$$
G_t = R_t + \gamma R_{t+1} + \gamma^2 R_{t+2} + ... = \sum_{k=0}^{\infty} \gamma^k R_{t+k}
$$
</div>

<p>Second, What is â€˜Return at time t + 1â€™?</p>
<div style="overflow-x: auto;">
$$
G_{t+1} = R_{t+1} + \gamma R_{t+2} + \gamma^2 R_{t+3} + ... = \sum_{k=0}^{\infty} \gamma^k R_{t+k+1}
$$
</div>

<p>So, we can rearrange the equation as above two equatios.</p>

<div style="overflow-x: auto;">
$$
G_t = R_t + \gamma G_{t+1}
$$
</div>

<p>We know the relation between \(G_t\) and \(G_{t+1}\).</p>

<p>Based on the state-vlaue function \(V_\pi(s)\) we obtained earlier, we can derived the following conclusion.</p>

<div style="overflow-x: auto;">
$$
V_\pi(s) = \mathbb{E}_\pi[G_t | S_t = s]
    = \mathbb{E}_\pi[R_t + \gamma G_{t+1} | S_t = s]
    = \mathbb{E}_\pi[R_t | S_t = s] + \gamma \mathbb{E}_\pi[G_{t+1} | S_t = s]
$$
</div>

<p>(Since Linearity of Expectation ğŸ‘‰ \(\mathbb{E}[X + Y] = \mathbb{E}[X] + \mathbb{E}[Y]\))</p>

						</div><!-- /.content -->
					</div><!-- /.col -->
					<div class="col-md-4 col-md-offset-1">
						<div class="sections-list-wrapper">
							<div class="sections-list js-sections js-affix js-scrollspy hidden-xs hidden-sm"></div><!-- /.sections-list -->
						</div>
					</div><!-- /.col -->
				</div><!-- /.row -->
			</div><!-- /.container -->
		</div><!-- /.section -->
		
			<div class="section section--grey">
				<div class="container">
					<div class="row">
						<div class="col-md-7">
							<div class="comments-area">
  <h3 class="comments-title">Comments</h3>
  <div id="comments-list" class="comments-list">
    <!-- Comments will be populated here -->
  </div>
  
  <div class="comment-respond">
    <h4 class="comment-reply-title">Leave a Comment</h4>
    <form id="comment-form" class="comment-form">
      <div class="form-group">
        <label for="name">Name</label>
        <input type="text" id="name" name="name" required class="form-control">
      </div>
      <div class="form-group">
        <label for="email">Email</label>
        <input type="email" id="email" name="email" required class="form-control">
      </div>
      <div class="form-group">
        <label for="comment">Comment</label>
        <textarea id="comment" name="comment" required class="form-control" rows="5"></textarea>
      </div>
      <div class="form-group admin-field">
        <label for="password">Admin Password</label>
        <input type="password" id="password" name="password" class="form-control" placeholder="For comment moderation">
      </div>
      <div class="form-submit">
        <button type="submit" class="btn btn--dark btn--rounded">Submit Comment</button>
      </div>
    </form>
  </div>
</div>

<script>
  (function() {
    // Simple storage for comments using localStorage
    const COMMENTS_STORAGE_KEY = 'page_comments_/reinforce/';
    
    // Load comments from storage
    function loadComments() {
      const comments = JSON.parse(localStorage.getItem(COMMENTS_STORAGE_KEY) || '[]');
      const commentsList = document.getElementById('comments-list');
      commentsList.innerHTML = '';
      
      if (comments.length === 0) {
        commentsList.innerHTML = '<div class="no-comments">No comments yet. Be the first to comment!</div>';
        return;
      }
      
      comments.forEach((comment, index) => {
        const commentDiv = document.createElement('div');
        commentDiv.className = 'comment';
        commentDiv.dataset.id = index;
        
        const commentHTML = `
          <div class="comment-meta">
            <div class="comment-author">
              <strong>${comment.name}</strong>
            </div>
            <div class="comment-metadata">
              <span>${new Date(comment.date).toLocaleDateString()} ${new Date(comment.date).toLocaleTimeString()}</span>
            </div>
          </div>
          <div class="comment-content">
            <p>${comment.text}</p>
          </div>
          <div class="comment-actions">
            <button class="btn-link reply-btn" data-id="${index}">
              <i class="icon icon--arrow-right"></i> Reply
            </button>
            <button class="btn-link delete-btn" data-id="${index}">
              <i class="icon icon--cross"></i> Delete
            </button>
          </div>
          <div class="reply-form-wrapper" id="reply-form-${index}" style="display: none;">
            <form class="reply-form" data-parent="${index}">
              <div class="form-group">
                <label for="reply-name-${index}">Name</label>
                <input type="text" id="reply-name-${index}" name="name" required class="form-control">
              </div>
              <div class="form-group">
                <label for="reply-comment-${index}">Reply</label>
                <textarea id="reply-comment-${index}" name="comment" required class="form-control" rows="3"></textarea>
              </div>
              <div class="form-submit">
                <button type="submit" class="btn btn--dark btn--rounded btn--sm">Submit Reply</button>
              </div>
            </form>
          </div>
          <div class="children" id="replies-${index}">
            ${renderReplies(comment.replies || [])}
          </div>
        `;
        
        commentDiv.innerHTML = commentHTML;
        commentsList.appendChild(commentDiv);
      });
      
      // Add event listeners to reply buttons
      document.querySelectorAll('.reply-btn').forEach(button => {
        button.addEventListener('click', function() {
          const commentId = this.dataset.id;
          const replyForm = document.getElementById(`reply-form-${commentId}`);
          replyForm.style.display = replyForm.style.display === 'none' ? 'block' : 'none';
        });
      });
      
      // Add event listeners to delete buttons
      document.querySelectorAll('.delete-btn').forEach(button => {
        button.addEventListener('click', function() {
          const commentId = this.dataset.id;
          const password = prompt('Enter admin password to delete:');
          
          if (password === 'admin123') { // Simple password for demo
            deleteComment(parseInt(commentId));
          } else {
            alert('Incorrect password');
          }
        });
      });
      
      // Add event listeners to reply forms
      document.querySelectorAll('.reply-form').forEach(form => {
        form.addEventListener('submit', function(e) {
          e.preventDefault();
          const parentId = parseInt(this.dataset.parent);
          const replyName = this.querySelector('[name="name"]').value;
          const replyText = this.querySelector('[name="comment"]').value;
          
          addReply(parentId, replyName, replyText);
          this.reset();
          document.getElementById(`reply-form-${parentId}`).style.display = 'none';
        });
      });
    }
    
    // Render replies
    function renderReplies(replies) {
      if (!replies || replies.length === 0) return '';
      
      let html = '';
      replies.forEach((reply, replyIndex) => {
        html += `
          <div class="comment child-comment" data-id="${replyIndex}">
            <div class="comment-meta">
              <div class="comment-author">
                <strong>${reply.name}</strong>
              </div>
              <div class="comment-metadata">
                <span>${new Date(reply.date).toLocaleDateString()} ${new Date(reply.date).toLocaleTimeString()}</span>
              </div>
            </div>
            <div class="comment-content">
              <p>${reply.text}</p>
            </div>
            <div class="comment-actions">
              <button class="btn-link delete-reply-btn" data-parent="${replyIndex}">
                <i class="icon icon--cross"></i> Delete
              </button>
            </div>
          </div>
        `;
      });
      return html;
    }
    
    // Add a new comment
    function addComment(name, email, text) {
      const comments = JSON.parse(localStorage.getItem(COMMENTS_STORAGE_KEY) || '[]');
      comments.push({
        name: name,
        email: email,
        text: text,
        date: new Date().toISOString(),
        replies: []
      });
      localStorage.setItem(COMMENTS_STORAGE_KEY, JSON.stringify(comments));
      loadComments();
    }
    
    // Add a reply to a comment
    function addReply(parentId, name, text) {
      const comments = JSON.parse(localStorage.getItem(COMMENTS_STORAGE_KEY) || '[]');
      if (!comments[parentId].replies) {
        comments[parentId].replies = [];
      }
      
      comments[parentId].replies.push({
        name: name,
        text: text,
        date: new Date().toISOString()
      });
      
      localStorage.setItem(COMMENTS_STORAGE_KEY, JSON.stringify(comments));
      loadComments();
    }
    
    // Delete a comment
    function deleteComment(commentId) {
      const comments = JSON.parse(localStorage.getItem(COMMENTS_STORAGE_KEY) || '[]');
      comments.splice(commentId, 1);
      localStorage.setItem(COMMENTS_STORAGE_KEY, JSON.stringify(comments));
      loadComments();
    }
    
    // Event listener for comment form
    document.getElementById('comment-form').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const name = document.getElementById('name').value;
      const email = document.getElementById('email').value;
      const comment = document.getElementById('comment').value;
      
      addComment(name, email, comment);
      this.reset();
    });
    
    // Initial load
    document.addEventListener('DOMContentLoaded', loadComments);
  })();
</script>

<style>
  /* Comments styling that matches Doks theme */
  .comments-area {
    margin-top: 2.5rem;
    font-family: 'Noto Sans', sans-serif;
  }
  
  .comments-title {
    margin-bottom: 1.5rem;
    font-size: 1.75em;
    font-weight: 600;
    color: #333;
  }
  
  .comment {
    margin-bottom: 1.5rem;
    padding: 1.25rem;
    background-color: #fff;
    border-radius: 4px;
    box-shadow: 0 1px 4px rgba(0,0,0,.04);
    border-left: 4px solid #253951;
    transition: all .2s ease;
  }
  
  .comment:hover {
    box-shadow: 0 1px 10px rgba(0,0,0,.08);
  }
  
  .comment-meta {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0.75rem;
  }
  
  .comment-author {
    font-weight: 600;
  }
  
  .comment-metadata {
    font-size: 0.75em;
    color: #8a8a8a;
  }
  
  .comment-content {
    line-height: 1.6;
    color: #333;
  }
  
  .comment-content p {
    margin-bottom: 0.5rem;
  }
  
  .comment-actions {
    margin-top: 0.75rem;
    padding-top: 0.5rem;
    border-top: 1px solid #f5f5f5;
  }
  
  .btn-link {
    background: none;
    border: none;
    padding: 0;
    color: #253951;
    cursor: pointer;
    font-size: 0.85em;
    text-decoration: none;
    margin-right: 1rem;
    transition: color .2s ease;
  }
  
  .btn-link:hover {
    color: #0056b3;
    text-decoration: underline;
  }
  
  .reply-form-wrapper {
    margin-top: 1rem;
    margin-bottom: 1rem;
    padding: 1rem;
    background-color: #f9f9f9;
    border-radius: 4px;
  }
  
  .children {
    margin-top: 1rem;
    margin-left: 1.5rem;
    padding-left: 1rem;
    border-left: 1px solid #eaeaea;
  }
  
  .child-comment {
    margin-bottom: 1rem;
    border-left: 3px solid #6c757d;
  }
  
  .no-comments {
    padding: 1rem;
    background-color: #f5f5f5;
    border-radius: 4px;
    font-style: italic;
    color: #666;
  }
  
  /* Form styling */
  .comment-respond {
    margin-top: 2rem;
    padding: 1.5rem;
    background-color: #f9f9f9;
    border-radius: 4px;
  }
  
  .comment-reply-title {
    margin-bottom: 1.25rem;
    font-size: 1.25em;
    font-weight: 600;
    color: #333;
  }
  
  .comment-form .form-group {
    margin-bottom: 1rem;
  }
  
  .comment-form label {
    display: block;
    margin-bottom: 0.5rem;
    font-weight: 600;
    color: #333;
  }
  
  .comment-form .form-control {
    width: 100%;
    padding: 0.75rem;
    border: 1px solid #e0e0e0;
    border-radius: 4px;
    background-color: #fff;
    font-family: inherit;
    font-size: 0.95em;
    transition: border-color .2s ease;
  }
  
  .comment-form .form-control:focus {
    border-color: #253951;
    outline: none;
  }
  
  .admin-field {
    opacity: 0.8;
  }
  
  .form-submit {
    margin-top: 1.5rem;
  }
  
  /* Match the Doks buttons */
  .btn {
    display: inline-block;
    font-weight: 500;
    text-align: center;
    white-space: nowrap;
    vertical-align: middle;
    user-select: none;
    padding: 0.75rem 1.25rem;
    font-size: 1rem;
    line-height: 1.5;
    border-radius: 4px;
    transition: all .2s ease-in-out;
    text-decoration: none;
    cursor: pointer;
  }
  
  .btn--dark {
    background-color: #253951;
    border-color: #253951;
    color: #fff;
  }
  
  .btn--dark:hover {
    background-color: #1a2a3c;
    border-color: #1a2a3c;
  }
  
  .btn--rounded {
    border-radius: 100px;
  }
  
  .btn--sm {
    padding: 0.5rem 1rem;
    font-size: 0.875rem;
  }
</style>

						</div><!-- /.col -->
					</div><!-- /.row -->
				</div><!-- /.container -->
			</div><!-- /.section -->
		
		<div class="js-footer-area">
			
			
				<div class="micro-nav">
	<div class="container">
		<div class="row">
			<div class="col-xs-12">
				<a href="/" class="micro-nav__back">
					<i class="icon icon--arrow-left"></i>
					Back to homepage
				</a><!-- /.micro-nav__back -->
			</div><!-- /.col -->
		</div><!-- /.row -->
	</div><!-- /.container -->
</div><!-- /.micro-nav -->

			
			
	<footer class="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-sm-6">
					
						<a href="/" class="site-footer__logo">InchanBaek Note</a>
					
					
						<hr>
						<p class="site-footer__copyright">Copyright &copy; 2017. - InchanBaek Note <br>All rights reserved.</p>
					
				</div><!-- /.col -->
				
					<div class="col-sm-6 align-right">
						<ul class="social-list">
							
								<li>
									<a href="https://www.linkedin.com/in/inchan-baek-728197265/" target="_blank" class="social-list__item social-list__item--linkedin">
										<i class="icon icon--linkedin"></i>
									</a>
								</li>
							
								<li>
									<a href="https://www.instagram.com/in_chanchan/" target="_blank" class="social-list__item social-list__item--instagram">
										<i class="icon icon--instagram"></i>
									</a>
								</li>
							
								<li>
									<a href="https://www.youtube.com/@icb6048" target="_blank" class="social-list__item social-list__item--youtube">
										<i class="icon icon--youtube"></i>
									</a>
								</li>
							
						</ul><!-- /.social-list -->
					</div><!-- /.col -->
				
			</div><!-- /.row -->
		</div><!-- /.container -->
	</footer><!-- /.site-footer -->


<script src="/doks-theme/assets/js/vendor/jquery.min.js"></script>
<script type="text/javascript" src="/doks-theme/assets/js/vendor/bootstrap/affix.min.js"></script>
<script type="text/javascript" src="/doks-theme/assets/js/vendor/bootstrap/scrollspy.min.js"></script>
<script type="text/javascript" src="/doks-theme/assets/js/vendor/matchHeight.min.js"></script>
<script type="text/javascript" src="/doks-theme/assets/js/scripts.min.js"></script>





		</div><!-- /.js-footer-area -->
	</body>
</html>